<section class="blog" id="blog">
    <h3 class="uk-h3" style="display: inline-block;">
        Installing Elasticsearch & Kibana Using Vagrant
    </h3>    <span class="uk-label uk-visible@s">Latest</span><br>
    <small class="uk-text-small uk-text-uppercase uk-text-muted">Monday 4th September, 2018</small>
    <p>
        We are going to install Elasticsearch v6.x and Kibana v6.x. This is (at least for me) the core parts of the
        “Elastic Stack”.
    </p>
    <p>
        The easiest way to get an Elasticsearch host setup locally is to install it on a virtual machine using Vagrant.
        <!-- If you don’t have Vagrant installed head over here.-->
    </p>
    <h4 class="mm-underlined">Setting Up Vagrant</h4>
    <p>
        Create a repository for your Vagrant project and cd into it. I have called mine `elasticsearch-getting-started`.
    </p>
    <p>
        To initialise a Ubuntu 16.04 box run the following:<br><br>
        <code>$ mkdir elasticsearch-getting-started && cd elasticsearch-getting-started</code><br />
        <code>$ vagrant init ubuntu/xenial64</code>
    </p>
    <p class="note">
        If you don't have Vagrant installed check out this <a href="">post</a> for instructions.
    </p>
    <p>
        Initialising the vagrant project will create a default file in the root of your project called `VagrantFile`. We
        need to make some manual edits to the generated VagrantFile to tell
        Vagrant where to find our provisioning script and to forward ports for Elasticsearch and Kibana to the host
        machine so we can access them in the browser.
    </p>

    <p>
        Open `VagrantFile` in your favourite editor and add the following inside the <code>Vagrant.configure</code> block to point vagrant to a provisioning script.
    </p>

    <div class="code-embed">
        <span data-gist-id="c280714d50683b1075e44780d8a14286" data-gist-line="16-19"></span>
    </div>
    <p>The
        provisioning script is called by Vagrant after the box is spun up for the first time. It will take care of the
        installation of all the required software and changing some configuration.</p>

    <p>
        Next, add the following to forward the ports 9200 (Elasticsearch) and 5601 (Kibana) to your host:
    </p>

    <div class="code-embed">
        <span data-gist-id="c280714d50683b1075e44780d8a14286" data-gist-line="19-23"></span>
    </div>

    <div uk-accordion>
        <div class="uk-background-muted mm-accordion-cta">
            <h6 class="uk-accordion-title">Expand to view the complete `VagrantFile`</h6>
            <div class="uk-accordion-content">
                <span data-gist-id="c280714d50683b1075e44780d8a14286" data-gist-highlight-line="17-18,20-22"></span>
            </div>
        </div>
    </div>
    <br/>
    <h4 class="mm-underlined">Provisioning the Virtual Machine</h4>
    <p>
        Next the provisioning script itself <code>bootstrap.sh</code>. The responsiblility of the provisioning script is
        to install the required software onto the virtual machine and to setup any configuration required. We are going
        to install Elasticsearch and its dependancies as well as Kibana. You can read more about Kibana <a
            href="https://www.elastic.co/guide/en/kibana/current/introduction.html">here</a>. In short, Kibana is to
        Elasticsearch what PhpMyAdmin is to MySQL.
    </p>
    <p>
        The first step it to install the Oracle JDK. The Elasticsearch <a
            href="https://www.elastic.co/guide/en/elasticsearch/reference/6.0/_installation.html">documentation</a> for
        version 6.x recommends the Oracle JDK version 1.8.0_131. To install the JDK we first need to grab the PPA from
        Oracle and update the license acceptance flags. Once this is done we can use the installer and set the
        environment path.
    </p>

    <div class="code-embed">
        <span data-gist-id="cf797b6d29a70f384803a1d6ede5c885" data-gist-line="2-17"></span>
    </div>

    <p>Once the Elasticsearch dependencies are properly installed the next step is to add the Elasticsearch repository
        definition to the apt sources list. This requires the `apt-transport-https` package to be installed. Once this
        is done we can add the repository definition and install both Elasticsearch and Kibana.</p>

    <div class="code-embed">
        <span data-gist-id="cf797b6d29a70f384803a1d6ede5c885" data-gist-line="17-31"></span>
    </div>

    <p>Now everything is installed its time to tweak some configuration. First off we need to give ownership of the
        Elasticsearch install directory to the ES group and user `elasticsearch:elasticsearch` and allow access to both
        from the host machine, so we can view both in the browser.</p>

    <div class="code-embed">
        <span data-gist-id="cf797b6d29a70f384803a1d6ede5c885" data-gist-line="31-38"></span>
    </div>

    <p>Now everything is installed and properly configured the next step is to start both Elasticsearch and Kibana.</p>

    <div class="code-embed">
        <span data-gist-id="cf797b6d29a70f384803a1d6ede5c885" data-gist-line="38-42"></span>
    </div>
    <div uk-accordion>
        <div class="uk-background-muted mm-accordion-cta">
            <h6 class="uk-accordion-title">Expand to view the complete `bootstrap.sh`</h6>
            <div class="uk-accordion-content">
                <span data-gist-id="cf797b6d29a70f384803a1d6ede5c885"></span>
            </div>
        </div>
    </div>
    <br/>

    <h4 class="mm-underlined">Is Everything is Working?</h4>
    <p>If everything is up and running as expected you will be able to find Elasticsearch at <a href="http://localhost:9200">http://localhost:9200</a> and Kibana at <a href="http://localhost:5601">http://localhost:5601</a>. </p>
    <p>A working Elasticsearch will return a JSON in your browser that looks a lot like this:</p>

    <div class="code-embed">
        <script src="https://gist.github.com/imikemiller/9c3a88e480a33e365b3a8340b82e1b4f.js"></script>
    </div>

    <p>And Kibana should load up and look something like this:</p>
    <img src="../../img/kibana-success.png">
    <p>And that is everything all set. Further posts to follow about how to query ES and how to avoid some of the gotchas.</p>

    <div class="uk-divider-icon"></div>
    <!--<h5>More Like This</h5>
    <ul class="uk-list">
        <li class="uk-position-relative list-item">
            <span class="uk-h3">Elasticsearch: Getting Started on Ubuntu</span><br>
            <small class="uk-text-small uk-text-uppercase uk-text-muted">Monday 4th September, 2018</small>
            <span uk-icon="icon: chevron-right; ratio:3" class="list-chevron uk-visible@s"></span>
        </li>
        <li class="uk-position-relative list-item">
            <span class="uk-h3">Elasticsearch: Debugging Scripts in Laravel</span><br>
            <small class="uk-text-small uk-text-uppercase uk-text-muted">Monday 4th September, 2018</small>
            <span uk-icon="icon: chevron-right; ratio:3" class="list-chevron uk-visible@s"></span>
        </li>
        <li class="uk-position-relative list-item">
            <span class="uk-h3">Elasticsearch: Building Queries in Laravel</span><br>
            <small class="uk-text-small uk-text-uppercase uk-text-muted">Monday 4th September, 2018</small>
            <span uk-icon="icon: chevron-right; ratio:3" class="list-chevron uk-visible@s"></span>
        </li>
        <li class="uk-position-relative list-item">
            <span class="uk-h3">Elasticsearch: "More like this" search</span><br>
            <small class="uk-text-small uk-text-uppercase uk-text-muted">Monday 4th September, 2018</small>
            <span uk-icon="icon: chevron-right; ratio:3" class="list-chevron uk-visible@s"></span>
        </li>
    </ul>
    <hr class="uk-divider-icon uk-margin-medium">
    <div id="bio">
        <span class="uk-h1">Bio</span>
        <h2>Work History</h2>
        <p>
            Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots in a piece of classical Latin
            literature from 45 BC, making it over 2000 years old. Richard McClintock, a Latin professor at Hampden-Sydney
            College in Virginia, looked up one of the more obscure Latin words, consectetur, from a Lorem Ipsum passage, and
            going through the cites of the word in classical literature, discovered the undoubtable source. Lorem Ipsum
            comes from sections 1.10.32 and 1.10.33 of "de Finibus Bonorum et Malorum" (The Extremes of Good and Evil) by
            Cicero, written in 45 BC. This book is a treatise on the theory of ethics, very popular during the Renaissance.
            The first line of Lorem Ipsum, "Lorem ipsum dolor sit amet..", comes from a line in section 1.10.32.
        </p>
        <h2>Technology</h2>
        <p>
            Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots in a piece of classical Latin
            literature from 45 BC, making it over 2000 years old. Richard McClintock, a Latin professor at Hampden-Sydney
            College in Virginia, looked up one of the more obscure Latin words, consectetur, from a Lorem Ipsum passage, and
            going through the cites of the word in classical literature, discovered the undoubtable source. Lorem Ipsum
            comes from sections 1.10.32 and 1.10.33 of "de Finibus Bonorum et Malorum" (The Extremes of Good and Evil) by
            Cicero, written in 45 BC. This book is a treatise on the theory of ethics, very popular during the Renaissance.
            The first line of Lorem Ipsum, "Lorem ipsum dolor sit amet..", comes from a line in section 1.10.32.
        </p>
        <h2>Technology</h2>
        <p>
            Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots in a piece of classical Latin
            literature from 45 BC, making it over 2000 years old. Richard McClintock, a Latin professor at Hampden-Sydney
            College in Virginia, looked up one of the more obscure Latin words, consectetur, from a Lorem Ipsum passage, and
            going through the cites of the word in classical literature, discovered the undoubtable source. Lorem Ipsum
            comes from sections 1.10.32 and 1.10.33 of "de Finibus Bonorum et Malorum" (The Extremes of Good and Evil) by
            Cicero, written in 45 BC. This book is a treatise on the theory of ethics, very popular during the Renaissance.
            The first line of Lorem Ipsum, "Lorem ipsum dolor sit amet..", comes from a line in section 1.10.32.
        </p>
        <code></code>
    </div>-->
</section>
